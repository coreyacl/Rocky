(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     34754,        876]
NotebookOptionsPosition[     32976,        837]
NotebookOutlinePosition[     33340,        853]
CellTagsIndexPosition[     33297,        850]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["QEA Night 10", "Title",
 CellChangeTimes->{{3.749835590462995*^9, 3.749835606524428*^9}, {
  3.750004562515197*^9, 3.750004563086873*^9}, {3.750005701651075*^9, 
  3.750005702556816*^9}, {3.750005765301928*^9, 
  3.7500057658709927`*^9}},ExpressionUUID->"d8f3ed80-8798-4905-b10d-\
3d744a2c2d5e"],

Cell[CellGroupData[{

Cell["Exercise ", "Section",
 CellChangeTimes->{{3.749835612257038*^9, 3.749835635760695*^9}, 
   3.750005704927021*^9},ExpressionUUID->"93767843-2eb6-49de-bce4-\
f15491e81863"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"eq1", " ", "=", " ", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "s", "]"}], "\[Equal]", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["e", "rr2"], "[", "s", "]"}], 
       RowBox[{
        SubscriptBox["G", "P"], "[", "s", "]"}], " ", 
       RowBox[{
        SubscriptBox["G", "MC"], "[", "s", "]"}], 
       RowBox[{
        SubscriptBox["G", "VC"], "[", "s", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq2", " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["V", "d"], "[", "s", "]"}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["e", "rr1"], "[", "s", "]"}], " ", 
       RowBox[{
        SubscriptBox["G", "PI"], "[", "s", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq3", " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["e", "rr1"], "[", "s", "]"}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "d"], "[", "s", "]"}], " ", "-", " ", 
       RowBox[{"\[Theta]", "[", "s", "]"}], " ", "+", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["G", "DC"], "[", "s", "]"}], 
        RowBox[{"V", "[", "s", "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq4", " ", "=", " ", 
     RowBox[{
      RowBox[{"V", "[", "s", "]"}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["e", "rr2"], "[", "s", "]"}], 
       RowBox[{
        SubscriptBox["G", "P"], "[", "s", "]"}], 
       RowBox[{
        SubscriptBox["G", "MC"], "[", "s", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq5", " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["e", "rr2"], "[", "s", "]"}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "d"], "[", "s", "]"}], " ", "-", " ", 
       RowBox[{"V", "[", "s", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol", " ", "=", " ", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"eq1", ",", "eq2", ",", "eq3", ",", "eq4", ",", "eq5"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "s", "]"}], ",", 
          RowBox[{
           SubscriptBox["V", "d"], "[", "s", "]"}], ",", 
          RowBox[{
           SubscriptBox["e", "rr1"], "[", "s", "]"}], ",", " ", 
          RowBox[{"V", "[", "s", "]"}], ",", " ", 
          RowBox[{
           SubscriptBox["e", "rr2"], "[", "s", "]"}]}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["G", "TOTALSYSTEM"], "[", "s", "]"}], "\[Rule]", " ", 
      FractionBox[
       RowBox[{"\[Theta]", "[", "s", "]"}], 
       RowBox[{
        SubscriptBox["\[Theta]", "d"], "[", "s", "]"}]]}], "/.", "sol"}], 
    "}"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "is", " ", "a", " ", "rule", " ", "to", " ", "replace", " ", 
      SubscriptBox["G", "TOTALSYSTEM"]}], ",", " ", 
     RowBox[{
     "you", " ", "can", " ", "just", " ", "extract", " ", "the", " ", "value",
       " ", "by", " ", "using", " ", "the", " ", "righthand", " ", "side", 
      " ", "of", " ", "the", " ", "rule"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"trans", " ", "=", " ", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"\[Theta]", "[", "s", "]"}], 
       RowBox[{
        SubscriptBox["\[Theta]", "d"], "[", "s", "]"}]], "/.", "sol"}], "/.", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["G", "PI"], "[", "s", "]"}], "\[Rule]", " ", 
        RowBox[{
         SubscriptBox["K", "p"], "+", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["K", "i"], "/", "s"}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["G", "VC"], "[", "s", "]"}], "\[Rule]", " ", 
        RowBox[{
         RowBox[{"-", "s"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"L", " ", 
            SuperscriptBox["s", "2"]}], "-", " ", "g"}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["G", "MC"], "[", "s", "]"}], "\[Rule]", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", " ", "b"}], " ", ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"s", "+", "a"}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["G", "P"], "[", "s", "]"}], "\[Rule]", " ", 
        RowBox[{
         SubscriptBox["J", "p"], "+", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["J", "i"], "/", "s"}], ")"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["G", "DC"], "[", "s", "]"}], "\[Rule]", " ", 
        RowBox[{
         SubscriptBox["K", "t"], "/", "s"}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"tsumsub", " ", "=", " ", 
    RowBox[{"Factor", "[", 
     RowBox[{"trans", " ", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"b", "\[Rule]", 
         RowBox[{"1", "/", "400"}]}], ",", 
        RowBox[{"a", "\[Rule]", "14"}], " ", ",", 
        RowBox[{"L", "\[Rule]", ".1"}], ",", 
        RowBox[{"g", "\[Rule]", "9.8"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.749829119364097*^9, 3.749829168588089*^9}, {
   3.7498293391374407`*^9, 3.749829371644505*^9}, {3.749831243295713*^9, 
   3.7498313660604343`*^9}, {3.749831414070016*^9, 3.74983143002873*^9}, {
   3.749831498588903*^9, 3.749831616304981*^9}, {3.7498316594171352`*^9, 
   3.749831685055554*^9}, {3.749831721084134*^9, 3.749831814200776*^9}, {
   3.749831939917667*^9, 3.749831943179277*^9}, {3.7498319734016027`*^9, 
   3.7498320977235413`*^9}, {3.749832499224195*^9, 3.749832571241515*^9}, {
   3.7498331680127363`*^9, 3.749833174423902*^9}, {3.749833919687367*^9, 
   3.749833937394889*^9}, 3.7498341002260513`*^9, 3.749834151570023*^9, {
   3.749834580551815*^9, 3.74983458196169*^9}, {3.749835202723139*^9, 
   3.7498352045887737`*^9}, {3.7500045883093977`*^9, 
   3.7500045933028173`*^9}, {3.750004676012884*^9, 3.750004815844181*^9}, {
   3.750004856769552*^9, 3.750004859489764*^9}, 3.75000512423602*^9, {
   3.750005181504992*^9, 3.7500052024410267`*^9}, {3.7500052521534433`*^9, 
   3.750005254642508*^9}, {3.750005690784993*^9, 3.7500057126753883`*^9}, {
   3.750067445708607*^9, 3.750067453233468*^9}, {3.750067493537787*^9, 
   3.750067501340366*^9}, {3.750067555145866*^9, 3.75006756347642*^9}, {
   3.750067970271531*^9, 3.750067976275367*^9}, {3.7500681854624324`*^9, 
   3.7500682275841827`*^9}, 3.7500684392695827`*^9, 3.7500692780504837`*^9, {
   3.750070285040808*^9, 3.750070327021502*^9}, {3.7500704057847624`*^9, 
   3.7500704309561186`*^9}, {3.750070479238015*^9, 3.7500706285752993`*^9}, {
   3.750070673018092*^9, 3.75007078429937*^9}, {3.7500719727711577`*^9, 
   3.750072090280178*^9}, {3.750072158722272*^9, 3.7500721812114334`*^9}, {
   3.7500722180967894`*^9, 3.750072237001185*^9}, {3.750072562434169*^9, 
   3.7500726892645683`*^9}, {3.750073033046668*^9, 3.7500730352890882`*^9}, {
   3.7500835707567563`*^9, 3.7500838623917847`*^9}, {3.7500839603519197`*^9, 
   3.7500839621796293`*^9}, {3.750083996369169*^9, 3.7500839970297995`*^9}, {
   3.75037506408989*^9, 3.750375080984923*^9}, 3.750375120668169*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"f67ceeb3-842f-4fef-8da5-f70bfffba3b1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["G", "TOTALSYSTEM"], "[", "s", "]"}], "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{
      SubscriptBox["G", "MC"], "[", "s", "]"}], " ", 
     RowBox[{
      SubscriptBox["G", "P"], "[", "s", "]"}], " ", 
     RowBox[{
      SubscriptBox["G", "PI"], "[", "s", "]"}], " ", 
     RowBox[{
      SubscriptBox["G", "VC"], "[", "s", "]"}]}], 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["G", "MC"], "[", "s", "]"}], " ", 
      RowBox[{
       SubscriptBox["G", "P"], "[", "s", "]"}]}], "-", 
     RowBox[{
      RowBox[{
       SubscriptBox["G", "DC"], "[", "s", "]"}], " ", 
      RowBox[{
       SubscriptBox["G", "MC"], "[", "s", "]"}], " ", 
      RowBox[{
       SubscriptBox["G", "P"], "[", "s", "]"}], " ", 
      RowBox[{
       SubscriptBox["G", "PI"], "[", "s", "]"}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["G", "MC"], "[", "s", "]"}], " ", 
      RowBox[{
       SubscriptBox["G", "P"], "[", "s", "]"}], " ", 
      RowBox[{
       SubscriptBox["G", "PI"], "[", "s", "]"}], " ", 
      RowBox[{
       SubscriptBox["G", "VC"], "[", "s", "]"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.750004803704*^9, 3.7500048606623983`*^9}, 
   3.75000512591094*^9, 3.750005204047059*^9, {3.7500674404103923`*^9, 
   3.7500674549262667`*^9}, 3.7500675040625825`*^9, 3.750067591942993*^9, {
   3.750067725167074*^9, 3.750067751779062*^9}, {3.7500678320449734`*^9, 
   3.7500678632476673`*^9}, 3.7500679241004953`*^9, 3.7500679768622417`*^9, 
   3.7500682368057117`*^9, 3.7500684521161027`*^9, 3.750068711866246*^9, 
   3.7500693839939404`*^9, 3.7500708085678916`*^9, {3.750071716873285*^9, 
   3.750071718832061*^9}, 3.7500721162187686`*^9, {3.750072238959957*^9, 
   3.7500722572166667`*^9}, 3.750072695768849*^9, 3.7500727408505287`*^9, {
   3.75007277454187*^9, 3.7500727856673136`*^9}, 3.750073039496108*^9, 
   3.7500839092604246`*^9, {3.7500839844713616`*^9, 3.7500839984461746`*^9}, 
   3.750084170391279*^9, 3.750374905139132*^9, 3.750375084371666*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"fd78388c-32eb-4bb3-b98f-017cb19e7c73"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"a", " ", "b", " ", "s", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SubscriptBox["J", "i"], "s"], "+", 
      SubscriptBox["J", "p"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SubscriptBox["K", "i"], "s"], "+", 
      SubscriptBox["K", "p"]}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a", "+", "s"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "g"}], "+", 
      RowBox[{"L", " ", 
       SuperscriptBox["s", "2"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{"a", " ", "b", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SubscriptBox["J", "i"], "s"], "+", 
          SubscriptBox["J", "p"]}], ")"}]}], 
       RowBox[{"a", "+", "s"}]], "-", 
      FractionBox[
       RowBox[{"a", " ", "b", " ", "s", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SubscriptBox["J", "i"], "s"], "+", 
          SubscriptBox["J", "p"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SubscriptBox["K", "i"], "s"], "+", 
          SubscriptBox["K", "p"]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "s"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g"}], "+", 
          RowBox[{"L", " ", 
           SuperscriptBox["s", "2"]}]}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"a", " ", "b", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SubscriptBox["J", "i"], "s"], "+", 
          SubscriptBox["J", "p"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SubscriptBox["K", "i"], "s"], "+", 
          SubscriptBox["K", "p"]}], ")"}], " ", 
        SubscriptBox["K", "t"]}], 
       RowBox[{"s", " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "s"}], ")"}]}]]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.750004803704*^9, 3.7500048606623983`*^9}, 
   3.75000512591094*^9, 3.750005204047059*^9, {3.7500674404103923`*^9, 
   3.7500674549262667`*^9}, 3.7500675040625825`*^9, 3.750067591942993*^9, {
   3.750067725167074*^9, 3.750067751779062*^9}, {3.7500678320449734`*^9, 
   3.7500678632476673`*^9}, 3.7500679241004953`*^9, 3.7500679768622417`*^9, 
   3.7500682368057117`*^9, 3.7500684521161027`*^9, 3.750068711866246*^9, 
   3.7500693839939404`*^9, 3.7500708085678916`*^9, {3.750071716873285*^9, 
   3.750071718832061*^9}, 3.7500721162187686`*^9, {3.750072238959957*^9, 
   3.7500722572166667`*^9}, 3.750072695768849*^9, 3.7500727408505287`*^9, {
   3.75007277454187*^9, 3.7500727856673136`*^9}, 3.750073039496108*^9, 
   3.7500839092604246`*^9, {3.7500839844713616`*^9, 3.7500839984461746`*^9}, 
   3.750084170391279*^9, 3.750374905139132*^9, 3.750375084402861*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"7d185fdd-fbc9-433e-8430-25a33ed22448"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"0.35000000000000003`", " ", 
      SuperscriptBox["s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1.`", " ", 
         SubscriptBox["J", "i"], " ", 
         SubscriptBox["K", "i"]}], "+", 
        RowBox[{"1.`", " ", "s", " ", 
         SubscriptBox["J", "p"], " ", 
         SubscriptBox["K", "i"]}], "+", 
        RowBox[{"1.`", " ", "s", " ", 
         SubscriptBox["J", "i"], " ", 
         SubscriptBox["K", "p"]}], "+", 
        RowBox[{"1.`", " ", 
         SuperscriptBox["s", "2"], " ", 
         SubscriptBox["J", "p"], " ", 
         SubscriptBox["K", "p"]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1372.`"}], " ", 
       SuperscriptBox["s", "3"]}], "-", 
      RowBox[{"98.`", " ", 
       SuperscriptBox["s", "4"]}], "+", 
      RowBox[{"14.`", " ", 
       SuperscriptBox["s", "5"]}], "+", 
      RowBox[{"1.`", " ", 
       SuperscriptBox["s", "6"]}], "-", 
      RowBox[{"3.43`", " ", 
       SuperscriptBox["s", "2"], " ", 
       SubscriptBox["J", "i"]}], "+", 
      RowBox[{"0.035`", " ", 
       SuperscriptBox["s", "4"], " ", 
       SubscriptBox["J", "i"]}], "-", 
      RowBox[{"3.43`", " ", 
       SuperscriptBox["s", "3"], " ", 
       SubscriptBox["J", "p"]}], "+", 
      RowBox[{"0.035`", " ", 
       SuperscriptBox["s", "5"], " ", 
       SubscriptBox["J", "p"]}], "-", 
      RowBox[{"0.35000000000000003`", " ", 
       SuperscriptBox["s", "2"], " ", 
       SubscriptBox["J", "i"], " ", 
       SubscriptBox["K", "i"]}], "-", 
      RowBox[{"0.35000000000000003`", " ", 
       SuperscriptBox["s", "3"], " ", 
       SubscriptBox["J", "p"], " ", 
       SubscriptBox["K", "i"]}], "-", 
      RowBox[{"0.35000000000000003`", " ", 
       SuperscriptBox["s", "3"], " ", 
       SubscriptBox["J", "i"], " ", 
       SubscriptBox["K", "p"]}], "-", 
      RowBox[{"0.35000000000000003`", " ", 
       SuperscriptBox["s", "4"], " ", 
       SubscriptBox["J", "p"], " ", 
       SubscriptBox["K", "p"]}], "+", 
      RowBox[{"3.43`", " ", 
       SubscriptBox["J", "i"], " ", 
       SubscriptBox["K", "i"], " ", 
       SubscriptBox["K", "t"]}], "-", 
      RowBox[{"0.035`", " ", 
       SuperscriptBox["s", "2"], " ", 
       SubscriptBox["J", "i"], " ", 
       SubscriptBox["K", "i"], " ", 
       SubscriptBox["K", "t"]}], "+", 
      RowBox[{"3.43`", " ", "s", " ", 
       SubscriptBox["J", "p"], " ", 
       SubscriptBox["K", "i"], " ", 
       SubscriptBox["K", "t"]}], "-", 
      RowBox[{"0.035`", " ", 
       SuperscriptBox["s", "3"], " ", 
       SubscriptBox["J", "p"], " ", 
       SubscriptBox["K", "i"], " ", 
       SubscriptBox["K", "t"]}], "+", 
      RowBox[{"3.43`", " ", "s", " ", 
       SubscriptBox["J", "i"], " ", 
       SubscriptBox["K", "p"], " ", 
       SubscriptBox["K", "t"]}], "-", 
      RowBox[{"0.035`", " ", 
       SuperscriptBox["s", "3"], " ", 
       SubscriptBox["J", "i"], " ", 
       SubscriptBox["K", "p"], " ", 
       SubscriptBox["K", "t"]}], "+", 
      RowBox[{"3.43`", " ", 
       SuperscriptBox["s", "2"], " ", 
       SubscriptBox["J", "p"], " ", 
       SubscriptBox["K", "p"], " ", 
       SubscriptBox["K", "t"]}], "-", 
      RowBox[{"0.035`", " ", 
       SuperscriptBox["s", "4"], " ", 
       SubscriptBox["J", "p"], " ", 
       SubscriptBox["K", "p"], " ", 
       SubscriptBox["K", "t"]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.750004803704*^9, 3.7500048606623983`*^9}, 
   3.75000512591094*^9, 3.750005204047059*^9, {3.7500674404103923`*^9, 
   3.7500674549262667`*^9}, 3.7500675040625825`*^9, 3.750067591942993*^9, {
   3.750067725167074*^9, 3.750067751779062*^9}, {3.7500678320449734`*^9, 
   3.7500678632476673`*^9}, 3.7500679241004953`*^9, 3.7500679768622417`*^9, 
   3.7500682368057117`*^9, 3.7500684521161027`*^9, 3.750068711866246*^9, 
   3.7500693839939404`*^9, 3.7500708085678916`*^9, {3.750071716873285*^9, 
   3.750071718832061*^9}, 3.7500721162187686`*^9, {3.750072238959957*^9, 
   3.7500722572166667`*^9}, 3.750072695768849*^9, 3.7500727408505287`*^9, {
   3.75007277454187*^9, 3.7500727856673136`*^9}, 3.750073039496108*^9, 
   3.7500839092604246`*^9, {3.7500839844713616`*^9, 3.7500839984461746`*^9}, 
   3.750084170391279*^9, 3.750374905139132*^9, 3.750375084407271*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"8ee1bfa6-3fa8-495a-928b-02c013f9ee8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7503750678076057`*^9, 
  3.750375069000739*^9}},ExpressionUUID->"a4832c67-37f9-4165-9a1d-\
7a0466b81774"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"0.24900000000000003`", " ", 
      SuperscriptBox["s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1.`", " ", 
         SubscriptBox["J", "i"], " ", 
         SubscriptBox["K", "i"]}], "+", 
        RowBox[{"1.`", " ", "s", " ", 
         SubscriptBox["J", "p"], " ", 
         SubscriptBox["K", "i"]}], "+", 
        RowBox[{"1.`", " ", "s", " ", 
         SubscriptBox["J", "i"], " ", 
         SubscriptBox["K", "p"]}], "+", 
        RowBox[{"1.`", " ", 
         SuperscriptBox["s", "2"], " ", 
         SubscriptBox["J", "p"], " ", 
         SubscriptBox["K", "p"]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "813.4000000000001`"}], " ", 
       SuperscriptBox["s", "3"]}], "-", 
      RowBox[{"98.`", " ", 
       SuperscriptBox["s", "4"]}], "+", 
      RowBox[{"8.3`", " ", 
       SuperscriptBox["s", "5"]}], "+", 
      RowBox[{"1.`", " ", 
       SuperscriptBox["s", "6"]}], "-", 
      RowBox[{"2.4402000000000004`", " ", 
       SuperscriptBox["s", "2"], " ", 
       SubscriptBox["J", "i"]}], "+", 
      RowBox[{"0.024900000000000002`", " ", 
       SuperscriptBox["s", "4"], " ", 
       SubscriptBox["J", "i"]}], "-", 
      RowBox[{"2.4402000000000004`", " ", 
       SuperscriptBox["s", "3"], " ", 
       SubscriptBox["J", "p"]}], "+", 
      RowBox[{"0.024900000000000002`", " ", 
       SuperscriptBox["s", "5"], " ", 
       SubscriptBox["J", "p"]}], "-", 
      RowBox[{"0.24900000000000003`", " ", 
       SuperscriptBox["s", "2"], " ", 
       SubscriptBox["J", "i"], " ", 
       SubscriptBox["K", "i"]}], "-", 
      RowBox[{"0.24900000000000003`", " ", 
       SuperscriptBox["s", "3"], " ", 
       SubscriptBox["J", "p"], " ", 
       SubscriptBox["K", "i"]}], "-", 
      RowBox[{"0.24900000000000003`", " ", 
       SuperscriptBox["s", "3"], " ", 
       SubscriptBox["J", "i"], " ", 
       SubscriptBox["K", "p"]}], "-", 
      RowBox[{"0.24900000000000003`", " ", 
       SuperscriptBox["s", "4"], " ", 
       SubscriptBox["J", "p"], " ", 
       SubscriptBox["K", "p"]}], "+", 
      RowBox[{"2.4402000000000004`", " ", 
       SubscriptBox["J", "i"], " ", 
       SubscriptBox["K", "i"], " ", 
       SubscriptBox["K", "t"]}], "-", 
      RowBox[{"0.024900000000000002`", " ", 
       SuperscriptBox["s", "2"], " ", 
       SubscriptBox["J", "i"], " ", 
       SubscriptBox["K", "i"], " ", 
       SubscriptBox["K", "t"]}], "+", 
      RowBox[{"2.4402000000000004`", " ", "s", " ", 
       SubscriptBox["J", "p"], " ", 
       SubscriptBox["K", "i"], " ", 
       SubscriptBox["K", "t"]}], "-", 
      RowBox[{"0.024900000000000002`", " ", 
       SuperscriptBox["s", "3"], " ", 
       SubscriptBox["J", "p"], " ", 
       SubscriptBox["K", "i"], " ", 
       SubscriptBox["K", "t"]}], "+", 
      RowBox[{"2.4402000000000004`", " ", "s", " ", 
       SubscriptBox["J", "i"], " ", 
       SubscriptBox["K", "p"], " ", 
       SubscriptBox["K", "t"]}], "-", 
      RowBox[{"0.024900000000000002`", " ", 
       SuperscriptBox["s", "3"], " ", 
       SubscriptBox["J", "i"], " ", 
       SubscriptBox["K", "p"], " ", 
       SubscriptBox["K", "t"]}], "+", 
      RowBox[{"2.4402000000000004`", " ", 
       SuperscriptBox["s", "2"], " ", 
       SubscriptBox["J", "p"], " ", 
       SubscriptBox["K", "p"], " ", 
       SubscriptBox["K", "t"]}], "-", 
      RowBox[{"0.024900000000000002`", " ", 
       SuperscriptBox["s", "4"], " ", 
       SubscriptBox["J", "p"], " ", 
       SubscriptBox["K", "p"], " ", 
       SubscriptBox["K", "t"]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.750004803704*^9, 3.7500048606623983`*^9}, 
   3.75000512591094*^9, 3.750005204047059*^9, {3.7500674404103923`*^9, 
   3.7500674549262667`*^9}, 3.7500675040625825`*^9, 3.750067591942993*^9, {
   3.750067725167074*^9, 3.750067751779062*^9}, {3.7500678320449734`*^9, 
   3.7500678632476673`*^9}, 3.7500679241004953`*^9, 3.7500679768622417`*^9, 
   3.7500682368057117`*^9, 3.7500684521161027`*^9, 3.750068711866246*^9, 
   3.7500693839939404`*^9, 3.7500708085678916`*^9, {3.750071716873285*^9, 
   3.750071718832061*^9}, 3.7500721162187686`*^9, {3.750072238959957*^9, 
   3.7500722572166667`*^9}, 3.750072695768849*^9, 3.7500727408505287`*^9, {
   3.75007277454187*^9, 3.7500727856673136`*^9}, 3.750073039496108*^9, 
   3.7500839092604246`*^9, {3.7500839844713616`*^9, 3.7500839984461746`*^9}, 
   3.750084170391279*^9, 3.750374905144412*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"c9a1f583-085b-4f6d-bdc0-bd0dce3d6444"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"poles", "=", 
   RowBox[{"ReIm", "[", 
    RowBox[{"Values", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Denominator", "[", "tsumsub", "]"}], " ", "\[Equal]", " ", 
        "0"}], ",", "s"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{"poles", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["K", 
        RowBox[{"p", " "}]], "\[Rule]", " ", 
       RowBox[{"-", "88"}]}], ",", " ", 
      RowBox[{
       SubscriptBox["K", 
        RowBox[{"i", " "}]], "\[Rule]", " ", 
       RowBox[{"-", "100"}]}], ",", 
      RowBox[{
       SubscriptBox["J", "p"], "\[Rule]", "10"}], ",", " ", 
      RowBox[{
       SubscriptBox["J", "i"], "\[Rule]", " ", "56"}], ",", " ", 
      RowBox[{
       SubscriptBox["K", "t"], "\[Rule]", " ", 
       RowBox[{"-", "0.1"}]}]}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.750068723219265*^9, 3.7500687612515593`*^9}, {
   3.7500687947865067`*^9, 3.750068851184176*^9}, 3.750069273850381*^9, {
   3.7500693369972086`*^9, 3.750069359071329*^9}, {3.750070820101574*^9, 
   3.750070823660895*^9}, {3.7500709492262597`*^9, 3.7500709800834937`*^9}, {
   3.7500727045076075`*^9, 3.750072709724403*^9}, {3.7500727552987857`*^9, 
   3.7500727558728695`*^9}, 3.7500730452900095`*^9, {3.7500839243209195`*^9, 
   3.7500839722889585`*^9}, {3.75037489836012*^9, 3.7503749112596273`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"390cd433-0367-4374-9bc4-fe7c12899142"],

Cell[BoxData[
 TemplateBox[{
  "Solve","ratnz",
   "\"Solve was unable to solve the system with inexact coefficients. The \
answer was obtained by solving a corresponding exact system and numericizing \
the result.\"",2,12,5,20474688650592145130,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.750374913585236*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"acc9c0f0-eee0-415b-9862-fa8ea9fead55"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Sweep", " ", "values", " ", "of", " ", "kp", " ", "and", " ", "ki"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"Kp_", ",", "Ki_", ",", "Jp_", ",", "Ji_", ",", "Kt_"}], "]"}], 
     " ", "=", " ", 
     RowBox[{"ReIm", "[", 
      RowBox[{"N", "[", 
       RowBox[{"Values", "[", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Denominator", "[", 
            RowBox[{"tsumsub", " ", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["K", "p"], "\[Rule]", "Kp"}], ",", 
               RowBox[{
                SubscriptBox["K", "i"], "\[Rule]", "Ki"}], ",", 
               RowBox[{
                SubscriptBox["J", "p"], "\[Rule]", "Jp"}], ",", " ", 
               RowBox[{
                SubscriptBox["J", "i"], "\[Rule]", "Ji"}], ",", 
               RowBox[{
                SubscriptBox["K", "t"], "\[Rule]", "Kt"}]}], "}"}]}], "]"}], 
           "\[Equal]", "0"}], ",", "s"}], "]"}], "]"}], "]"}], "]"}]}], ";"}],
    " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"returns", " ", "list", " ", "as", " ", "s"}], "\[Rule]", 
     RowBox[{"[", 
      RowBox[{"[", "values", "]"}], "]"}]}], "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"Kp", ",", "Ki", ",", "Jp", ",", "Ji", ",", "Kt"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Kp", "\[Rule]", " ", "kp"}], ",", " ", 
          RowBox[{"Ki", "\[Rule]", " ", "ki"}], ",", " ", 
          RowBox[{"Jp", "\[Rule]", "jp"}], ",", " ", 
          RowBox[{"Ji", "\[Rule]", " ", "ji"}], ",", " ", 
          RowBox[{"Kt", "\[Rule]", "kt"}]}], "}"}]}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Real\>\"", ",", "\"\<Imaginary\>\""}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"PointSize", "[", "Large", "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "30"}], ",", "30"}], "}"}]}], "}"}]}]}], "]"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"kp", ",", 
       RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ki", ",", 
       RowBox[{"-", "200"}], ",", "200"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"jp", ",", 
       RowBox[{"-", "50"}], ",", "50"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ji", ",", 
       RowBox[{"-", "60"}], ",", " ", "60"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kt", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzU0ow3EAxvFtSlOag5AVWltDHGb0P2B5GymjzCZRklibVlubiNRGibGD
oUgcJgcvxX+Sl+Ul8lIbJq1ttqSkZJa3yJHfs8PT5/Z8ee06eSeLwWCkkUFa
2RMv+XgtK4/xp8LCkLwejlcUKKFjVqCBk+ocPXRR7d3QcP7SD7NyVwchWyYd
htWedAvM8zCt8IbZcgI5fHPUrlLbExR+Jz9Hfy0zEViV0vgBRb/iRBtxevyH
C6cShuwbxMC9M+p8cD2bJtYYR8VQe2RqhGeCtw4YacrVwjqNMaru/F0PVRlW
A3yUG+1wRC9ehArf0jLcd7FXYFB0sQflPI4TDkSclQ5ibIOpFuYsuJthyWFq
CxTGPbTC/EJFGzT/eTqhge5VwbHjtQmYFJbZIEX1FW0SWekKCZTxC7Z3iFyr
9xR+0S437NeJLmEo7LjaJaq3jNfQO+cMwFtq9w5KM1N8lZ+kU3zgh//4VwsP

  "],
 CellLabel->"In[38]:=",ExpressionUUID->"b67e67b7-ffb8-403c-8042-a41dcfa48ace"],

Cell[BoxData[
 TemplateBox[{
  "Solve","ratnz",
   "\"Solve was unable to solve the system with inexact coefficients. The \
answer was obtained by solving a corresponding exact system and numericizing \
the result.\"",2,38,11,20474688650592145130,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7500694002703433`*^9, 3.7500695221660175`*^9, 3.750069577011753*^9, 
   3.750069713095111*^9, 3.7500708969081106`*^9, 3.750071001399225*^9, 
   3.750071043461334*^9, 3.7500710924664793`*^9, 3.7500714350129833`*^9, 
   3.7500717315197997`*^9, 3.7500721262126584`*^9, 3.7500728113450603`*^9, 
   3.7500730529651966`*^9, 3.7500841007132463`*^9, 3.750084135403586*^9, {
   3.750084185913125*^9, 3.750084193948333*^9}, 3.7500862603223248`*^9, 
   3.7500863501286182`*^9, 3.750374916630974*^9, 3.7503751401517363`*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"3a718bdd-7558-43fc-a9ca-caaa31cff35e"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ji$$ = 60., $CellContext`jp$$ = 
    20., $CellContext`ki$$ = -120., $CellContext`kp$$ = -60, \
$CellContext`kt$$ = -0.09999999999999998, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`kp$$], -100, 100}, {
      Hold[$CellContext`ki$$], -200, 200}, {
      Hold[$CellContext`jp$$], -50, 50}, {
      Hold[$CellContext`ji$$], -60, 60}, {
      Hold[$CellContext`kt$$], -1, 1}}, Typeset`size$$ = {
    1713., {527., 536.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`kp$9374$$ = 
    0, $CellContext`ki$9375$$ = 0, $CellContext`jp$9376$$ = 
    0, $CellContext`ji$9377$$ = 0, $CellContext`kt$9378$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ji$$ = -60, $CellContext`jp$$ = -50, \
$CellContext`ki$$ = -200, $CellContext`kp$$ = -100, $CellContext`kt$$ = -1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`kp$$, $CellContext`kp$9374$$, 0], 
        Hold[$CellContext`ki$$, $CellContext`ki$9375$$, 0], 
        Hold[$CellContext`jp$$, $CellContext`jp$9376$$, 0], 
        Hold[$CellContext`ji$$, $CellContext`ji$9377$$, 0], 
        Hold[$CellContext`kt$$, $CellContext`kt$9378$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListPlot[
        ReplaceAll[
         $CellContext`f[$CellContext`Kp, $CellContext`Ki, $CellContext`Jp, \
$CellContext`Ji, $CellContext`Kt], {$CellContext`Kp -> $CellContext`kp$$, \
$CellContext`Ki -> $CellContext`ki$$, $CellContext`Jp -> $CellContext`jp$$, \
$CellContext`Ji -> $CellContext`ji$$, $CellContext`Kt -> $CellContext`kt$$}], 
        AxesLabel -> {"Real", "Imaginary"}, PlotStyle -> PointSize[Large], 
        PlotRange -> {{-10, 10}, {-30, 30}}], 
      "Specifications" :> {{$CellContext`kp$$, -100, 
         100}, {$CellContext`ki$$, -200, 200}, {$CellContext`jp$$, -50, 
         50}, {$CellContext`ji$$, -60, 60}, {$CellContext`kt$$, -1, 1}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{1783., {724., 734.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Input",
 CellChangeTimes->{{3.7503752966719112`*^9, 
  3.750375297095353*^9}},ExpressionUUID->"a21386a3-139a-4dbd-a276-\
e14e17b336f8"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.750067687240328*^9, 3.750067716159381*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"27e0620c-5a6f-404d-a6f2-9f566e805344"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1981, 1097},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.6 Inherited,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 301, 5, 156, "Title",ExpressionUUID->"d8f3ed80-8798-4905-b10d-3d744a2c2d5e"],
Cell[CellGroupData[{
Cell[906, 31, 177, 3, 108, "Section",ExpressionUUID->"93767843-2eb6-49de-bce4-f15491e81863"],
Cell[CellGroupData[{
Cell[1108, 38, 7580, 189, 521, "Input",ExpressionUUID->"f67ceeb3-842f-4fef-8da5-f70bfffba3b1"],
Cell[8691, 229, 2162, 51, 86, "Output",ExpressionUUID->"fd78388c-32eb-4bb3-b98f-017cb19e7c73"],
Cell[10856, 282, 2978, 80, 149, "Output",ExpressionUUID->"7d185fdd-fbc9-433e-8430-25a33ed22448"],
Cell[13837, 364, 4446, 110, 140, "Output",ExpressionUUID->"8ee1bfa6-3fa8-495a-928b-02c013f9ee8d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18320, 479, 154, 3, 49, "Input",ExpressionUUID->"a4832c67-37f9-4165-9a1d-7a0466b81774"],
Cell[18477, 484, 4610, 110, 137, "Output",ExpressionUUID->"c9a1f583-085b-4f6d-bdc0-bd0dce3d6444"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23124, 599, 1562, 38, 87, "Input",ExpressionUUID->"390cd433-0367-4374-9bc4-fe7c12899142"],
Cell[24689, 639, 443, 10, 34, "Message",ExpressionUUID->"acc9c0f0-eee0-415b-9862-fa8ea9fead55"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25169, 654, 3591, 95, 228, "Input",ExpressionUUID->"b67e67b7-ffb8-403c-8042-a41dcfa48ace"],
Cell[28763, 751, 939, 17, 34, "Message",ExpressionUUID->"3a718bdd-7558-43fc-a9ca-caaa31cff35e"]
}, Open  ]],
Cell[29717, 771, 3007, 57, 1481, InheritFromParent,ExpressionUUID->"a21386a3-139a-4dbd-a276-e14e17b336f8"],
Cell[32727, 830, 221, 3, 49, "Input",ExpressionUUID->"27e0620c-5a6f-404d-a6f2-9f566e805344"]
}, Open  ]]
}, Open  ]]
}
]
*)

